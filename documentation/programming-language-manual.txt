(СОВЕРШЕННО СЕКРЕТНО)
МАШИНА РАЗЛИЧИЙ		версия 2.x

Директории
----------

База данных состоит из ряда связанных директорий (таблиц).
Этот полный список индексов -- ценнейшая игровая информация.

НОМЕРА ЗАПИСЕЙ В ДИРЕКТОРИЯХ ПРИНЯТО НАЧИНАТЬ С НОМЕРА ДИРЕКТОРИИ
например: преступления - 1xxxxx, номера счетов - 2xxxxx, номера патентов - 3xxxxx и т.п.
ЛИЧНЫЕ ИНДЕКСЫ - исключение, их можно делать любыми шестизначными номерами
(но это не обязательное требование)

1. Директория граждан (government)

запись:
	01 * 00 * личный индекс = ЛИ (числовой, шестизначный)
	02 * 03 * статус ("ALIVE", "RIP")
	03 * 03 * фамилия
	04 * 03 * имя
	05 * 03 * пол ("MALE", "FEMALE")
	06 * 01 * возраст (лет)
	07 * 03 * социальный статус
	08 * 00 * отец (ЛИ)
	09 * 00 * мать (ЛИ)
	0A * 03 * внешний вид
	0B * 00 * супруг/супруга (ЛИ)
	0C * 0A * дети (список ЛИ)
	0D * 01 * код доступа (цифровой)
	0E * 0E * дополнительные сведения = текст с датами и записями
	0F * 0F * история обращений = список из записей вида "дата время, ЛИ, номера записей, история изменений"

	поле 0D закрыто для чтения и записи из программы, может быть задано только в первый раз и затем доступно только через аппаратную проверку

2. Директория преступлений (crime)

запись:
	11 * 00 * номер преступления
	12 * 03 * статус ("OPEN", "CLOSED")
	13 * 03 * тип преступления, статьи УК
	14 * 03 * место преступления
	15 * 04 * дата и время
	16 * 0A * подозреваемые (список ЛИ)
	17 * 0A * свидетели (список ЛИ)
	18 * 0A * потерпевшие (список ЛИ)
	19-1D ЗАРЕЗЕРВИРОВАНО
	1E * 03 * дополнительные сведения = свободный текст
	1F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений"

3. Директория финансов (finance)

запись:
	21 * 00 * номер счета (числовой, шестизначный)
	22 * 00 * владелец счета (ЛИ)
	23 * 0A * пайщики (список ЛИ)
	24 * 02 * баланс в фунтах
	25 * 0F * история транзакций (список вида "дата-время, номер счета отправителя, +/- сумма, описание")
	26 * 0A * корабли (список ЛИ)
	27 * 03 * собственность
	28 * 01 * черные металлы (т)
	29 * 01 * цветные металлы (т)
	2A * 01 * уголь (т)
	2B * 01 * каучук (т)
	2C * 01 * химия (т)
	2D ЗАРЕЗЕРВИРОВАНО
	2E * 03 * дополнительные сведения = свободный текст
	2F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений"

4. Директория патентов и изобретений (patents)

запись:
	31 * 00 * номер патента (числовой, шестизначный)
	32 * 0A * первооткрыватели (список ЛИ)
	33 * 03 * название
	34 * 03 * научная область (механика, электрика, оптика, акустика, химия, магнетизм, термодинамика, кинетика, иное)
	35 * 03 * вид действия
	36 * 04 * дата и время выдачи
	37 * 03 * вычислительная задача (формула в виде строки)
	38 * 02 * результат расчета
	39 * 03 * вычислительная задача (набор слов)
	3A-3D ЗАРЕЗЕРВИРОВАНО
	3E * 03 * дополнительные ограничения
	3F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений"

5. Директория оракула (oracle)

запись:
	41 * 00 * номер прогноза (числовой, шестизначный)
	42 * 00 * автор запроса (ЛИ)
	43 * 03 * текст запроса
	44 * 03 * математическая зависимость (например, "f(X, Y) + g(Z)")
	45 * 03 * ответ оракула
	46 * 04 * дата и время ответа
	47-4E ЗАРЕЗЕРВИРОВАНО
	4F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений" 

	+ служебное поле -- галочка от игротехника

6. Директория Офиса по внешним связям (foreign)

запись:
	51 * 00 * номер сообщения (числовой, шестизначный)
	52 * 03 * тип сообщения ("IN" или "OUT")
	53 * 00 * гражданин (получатель или отправитель соответственно) (ЛИ)
	54 * 03 * адресат (отправитель или получатель вне страны)
	55 * 04 * дата и время отправления
	56-5D ЗАРЕЗЕРВИРОВАНО
	5E * 03 * текст сообщения
	5F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений" 

7. Директория Флотов (fleet)

запись:
	61 * 00 * номер корабля (числовой, шестизначный)
	62 * 03 * тип корабля
	63 * 03 * название
	64 * 00 * владелец (ЛИ)
	65 * 00 * капитан (ЛИ)
	66 * 01 * грузоподъемность (т)
	67 * 03 * местоположение
	68 * 0E * история фрахтов перемещений (список записей "дата, описание")
	69-6D ЗАРЕЗЕРВИРОВАНО
	6E * 03 * дополнительные сведения
	6F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений"

8. Директория Военного министерства (army)

запись:
	71 * 00 * номер армии/флота (числовой, шестизначный)
	72 * 03 * тип армии/флота
	73 * 03 * название
	74 * 00 * командующий (ЛИ)
	75 * 03 * местоположение
	76 * 03 * текущий состав (для армии)
	77 * 0A * состав кораблей (для армии) (список индексов)
	78 * 0E * история боевых действий и перемещений (список записей "дата, описание")
	79-7D ЗАРЕЗЕРВИРОВАНО
	7E * 03 * дополнительные сведения
	7F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений" 

ДИРЕКТОРИЯ D8 ЗАРЕЗЕРВИРОВАНА

10. Служебная директория программ (system)

запись:
	91 * 00 * номер программы (числовой, шестизначный)
	92 * 03 * состояние ("QUEUED", "PAUSED", "FINISHED")
	93 * 00 * автор/заказчик (ЛИ)
	94 * 00	* оператор (ЛИ)
	95 * 0E * текст программы (набор строк)
	96 * 01 * расчетное время выполнения
	97 * 01 * приоритет выполнения
	98 * 04 * дата и время создания
	99 * 01 * последняя строка исполнения
	98-9E ЗАРЕЗЕРВИРОВАНО
	9F * 0F * история обращений = список из записей вида "дата время, ЛИ, история изменений" 

	+ служебное поле -- содержание стека

Машинный язык для программистов
-------------------------------

Машинный язык состоит из небольшого набора базовых команд:

команды по работе с данными:
0. CHOOSE -- запросить данные из МР
1. REQUEST -- запросить набор данных из МР
2. MODIFY -- изменить данные в МР
3. ADD -- добавить данные в МР
(обращаю внимание, что удалить ничего нельзя!)

вычислительные команды:
4. CALC -- вычислить значение формулы
5. STAT -- вычислить значение формулы с использованием данных из МР

управляющие команды МР
6. RECORD -- получить запись из набора
7. LOOP -- цикл в программе

вывод данных:
8. TYPE -- вывод информации из программы на телетайп

встроенные подпрограммы:
* ORACLE -- рассчитывает прогноз на основе формулы
* INTEGRAL -- вычисляет интеграл от заданной функции и предела интегрирования
* FIN -- набор подпрограмм по работе с финансами

Описание команд:

CHOOSE <переменная> <индекс> IF <условие>

	Одна команда может обращаться только к индексам ОДНОЙ директории.

	AND, OR, NOT - логические операции в условиях
	могут объединяться в скобки ()
	приоритет: (), NOT, AND, OR

	CHOOSE	[A3]	[03]	IF [01] = #123456
	CHOOSE	[B3]	[04]	IF [01] = #123456
	CALC	[C3]	[A3] + " " + [B3]
		получить имя и фамилию человека с личным индексом 123456 и объединить их в переменную C3

	СHOOSE	[A0]	[01]	IF [03] = "Смит" AND [05] = "MALE"
	CHOOSE  [A2]	[23]	IF [22] = [A0] 
		получить содержимое счета мужчин по фамилии Смит	

REQUEST	<переменная-набор> <индекс> [IF условие]

	Одна команда может обращаться только к индексам ОДНОЙ директории.

	REQUEST	[AB]	[01]
		набор всех индексов всех граждан
	REQUEST [AB]	[01] 	IF [03] ~ "Сми"
		набор всех индексов граждан, содержащих строку 'Сми'
	СHOOSE	[A0]	[01]	IF [03] = "Смит"
	REQUEST [AB]	[21]	IF [22] = [A0]
		набор всех номеров счетов, принадлежащих гражданину по фамилии "Смит"
	REQUEST [AE]	[0F]	IF [01] = #123456
		получает набор всех обращений к записи гражданина с индексом 123456
	REQUEST [AF]	[D0]	IF [05] = "MALE"
		получает набор всех записей для граждан-мужчин		

MODIFY	<индексное поле> <перменная с индексом или константа> <поле для записи> <переменная с данными или константа>
	
	Находит строку с индексом, равным значению первой переменной или константы и записывает в соответствующее
	ей поле вторую переменную или константу

	CHOOSE 	[A0]	[01]	LAST
	MODIFY	[01]	[A0]	[02]	"RIP"
		Изменяет статус последнего добавленного гражданина на "RIP"

ADD	<директория>	<индекс и значение через запятую>

	добавляет запись в директорию.
	неуказанные поля устанавливаются в пустое множество (00)
	
	ADD	[D0]	[01] #123457, [02] "ALIVE", [03] "Смит", [04] "Джон", [05] "MALE", [06] 1880-10-12, [08] #122345, [0A] "маленький-корявенький"
		добавляет новую запись в директорию

CALC	<переменная> <выражение>

	Рассчитывает значение переменной как результат выражения. Могут использоваться константы и перменные.

	CALC	[A1] 	3 * 2 ^ [B1]
	CALC	[B3]	"Мама " + [C3] + " раму"
	CALC	[B1]	[B1] % 3

STAT    <переменная> <выражение с наборной перменной>

	доступные функции статистики в применение к наборной переменной
	MIN - минимум
	MAX - максимум
	AVG - среднее арифметическое
	SIZE - число

	необязательное условие IF позволяет ограничить набор данных для статистики

	REQUEST	[AC]	[23]
	STAT	[A1]	MAX([AC])
		вычисляет максимальное значение счета
	REQUEST [AA]	[0C]
	STAT	[A2]	AVG([AA])
		вычисляет среднее число детей в Британии

	REQUEST	[AA]	[01]	IF 	[05] = "FEMALE"
	REQUEST [BA]	[11]	IF	[AA] INCLUDES [12]
	STAT	[A2]	COUNT([BA]) / COUNT([AA])
		высичляет среднее число преступлений для всех женщин Британии

RECORD <переменная-назначения> <наборная переменная> <индексная переменная|номер индекса>
	
	возвращает скалярную переменную из массива по индексу из переменной или константы

LOOP <индексная переменная> <целочисленная переменная|число шагов> 

	начинает цикл с заданным числом шагов с указанной инкрементирующейся перменной

	LOOP END завершает цикл
	ВЛОЖЕННЫЕ ЦИКЛЫ ЗАПРЕЩЕНЫ

TYPE <список через запятую: переменная, выражение или результат операции>
	выводит текст и данные на телетайп

	TYPE	"бла-бла"
	TYPE	[AE]
	TYPE	"Доход за последний год: ", [A2], " фунтов"

	REQUEST	[AA]	[01]
	TYPE	[AA]
		выводит список всех индексов граждан в МР

ORACLE	<дробная переменная> <номер запроса в директории оракула>
	
	возвращает достоверность прогноза 0.00-100.0 в процентах

	ORACLE	[A2], #222
		вычисляет вероятность для прогноза номер 222

INTEGRAL <дробная переменная> <начальный предел> <конечный предел> <строка функции>

	INTEGRAL	[A2]	0	10	"x ^ 2 - sin(x)"

	CALC		[A2]	10.0 / SQRT(20)
	INTEGRAL	[B2]	0	[A2]	"2 - x ^ 2"

ВСЕ ИНДЕКСЫ И РЕГИСТРЫ В ПРОГРАММЕ ЗАКЛЮЧАЮТСЯ В КВАДРАТНЫЕ СКОБКИ []

Типы данных
-----------

	00 * Индекс
	01 * Целые числа 
	02 * Дробные числа
	03 * Текст
	04 * Дата и время
	05-09 ЗАРЕЗЕРВИРОВАНО
	0A * Набор индексов [00]
	0B * Набор целых чисел [01]
	0C * Набор дробных чисел [02]
	0D * Набор даты-времени [04]
	0E * Набор текстов [03]
	0F * Набор наборов

Регистры в программах
---------------------

Свободные регистры (3 штуки): Ax Bx Cx
Свободные регистры уникальны для каждой программы

Отладочные регистры
-------------------

Ex - регистры, содержащие отладочную информацию и сведения об ошибках

	E0 - результат выполнения последней команды (см. код ниже)
	E1 - математическая ошибка (0 = все верно, 1 = деление на нуль, 2 = комплексное число, 3 = переполнение)
	E2 - текстовое описание ошибки программатора
	E3 - последняя команда программы в виде строки
	E4 - машинное время, затраченное на выполнение последней команды
	E5 - равно 1, если обращение к данным директорий вернула нуль ([00])
	E6-EF ЗАРЕЗЕРВИРОВАНО

Известные коды ошибок (десятичное число)

	00 - команда выполнена верно
	01 - неверный синтаксис командной строки
	02 - неверная команда
	03 - неправильный синтаксис параметров команды
	04 - неправильное значение параметров команды
	05 - команда не поддерживается
	06 - математическая ошибка
	07 - неверная переменная в команде
	08 - неразрешенная переменная в команде
	09 - несоответствие переменной в команде
	10 - противоречивое условие или запрос

Отладочный регистр уникален в рамках каждой программы		

Управляющий регистр
-------------------

Глобальный.

Fx - служебная информация

	F0 - число тактов с начала старта машины
	F1 - режим работы машины (0 = командный терминал, 1 = построчное исполнение, 2 = программное исполнение)
	F2 - номер исполняемой программы
	F3 - номер строки в исполняемой программе
	F4 - приоритет исполняемой программы
	F5 - список программ в очереди
	F6 - идентификатор текущего оператора (ЛИ) 
	F7 - уровень исполнения (0 = высокий, 1 = оператор, 2 = низкий)
	F8-FF ЗАРЕЗЕРВИРОВАНО

Константы
---------

1. Целые числа		0 1223 -22
2. Дробные числа 	0.222 -12.0004 13e10
3. Текст		"бла-бла" "символ кавычки задается так две кавычки подряд как тут """
4. Индекс		#102563
5. Пустое множество	00
6. Дата и время		1875-12-2-12pm54 или 1876-05-12 (время берется за 12am00) или 16pm40 (дата берется за сегодняшнюю)

Арифметические операции в формулах (команды STAT или CALC)
----------------------------------------------------------

сложение, вычитание, умножение, деление		а+б, а-б, а*б, а/б
отрицание (унарный минус)			-число
возведение в степень				показатель ^ степень
квадратный корень				SQRT(число)
экспонента					EXP(число)
натуральный логарифм				LN(число)
синус, косинус, тангенс				SIN, COS, TG
взятие остатка от деления			число % делитель

логическое равенство				=
неравенства					>= <= > < 
неравенство					!=
примерное равенство (для строк и дат)		~
значение содержится в списке			наборная-переменная INCLUDES значение


